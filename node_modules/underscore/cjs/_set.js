var isNumber = require('underscore/cjs/isNumber.js');
var isArray = require('underscore/cjs/isArray.js');
var isObject = require('underscore/cjs/isObject.js');

function set (obj, path, value) {
  var key = String(path[0]);

  if (path.length === 1) {
    obj[key] = value;
    return;
  }

  if (!isArray(obj[key]) || !isObject(obj[key])) {
    var nextKey = path[1];
    obj[key] = isNumber(nextKey) ? [] : {};
  }

  return set(obj[key], path.slice(1), value);
}

module.exports = set;
