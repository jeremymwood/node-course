var restArguments = require('underscore/cjs/restArguments.js');
var isFunction = require('underscore/cjs/isFunction.js');
var negate = require('underscore/cjs/negate.js');
var map = require('underscore/cjs/map.js');
var _flatten = require('underscore/cjs/_flatten.js');
var contains = require('underscore/cjs/contains.js');
var pick = require('underscore/cjs/pick.js');

// Return a copy of the object without the disallowed properties.
var omit = restArguments(function(obj, keys) {
  var iteratee = keys[0], context;
  if (isFunction(iteratee)) {
    iteratee = negate(iteratee);
    if (keys.length > 1) context = keys[1];
  } else {
    keys = map(_flatten(keys, false, false), String);
    iteratee = function(value, key) {
      return !contains(keys, key);
    };
  }
  return pick(obj, iteratee, context);
});

module.exports = omit;
